# =================
# Fleets Components
# =================

components:

  schemas:

    fleet_vehicle_base:
      description: Base Fleet-Vehicle Entity Definition
      type: object
      required:
        - quantity
      properties:
        quantity:
          type: integer

    fleet_vehicle_submit_only:
      description: Submit-Only Fleet-Vehicle Entity Definition
      type: object
      required:
        - vehicle_id
      properties:
        vehicle_id:
          type: integer

    fleet_base:
      description: Base Fleet Entity Definition
      type: object
      properties:
        name:
          type: string

    fleet_submit_only:
      description: Submit-Only Fleet Entity Definition
      type: object
      properties:
        vehicles:
          type: array
          items:
            allOf:
              - $ref: "#/components/schemas/fleet_vehicle_base"
              - $ref: "#/components/schemas/fleet_vehicle_submit_only"

    fleet_response_only:
      description: Response-Only Fleet Entity Definition
      type: object
      properties:
        vehicles:
          type: array
          items:
            allOf:
              - $ref: "#/components/schemas/fleet_vehicle_base"
              - $ref: "vehicles.yaml#/components/schemas/vehicle_get"

    fleet_get:
      description: HTTP GET Fleet Entity Definition
      required:
        - id
        - name
      allOf:
        - $ref: "components.yaml#/components/schemas/id_number"
        - $ref: "#/components/schemas/fleet_base"
        - $ref: "#/components/schemas/fleet_response_only"

    fleet_patch:
      description: HTTP PATCH Fleet Entity Definition
      allOf:
        - $ref: "#/components/schemas/fleet_base"
        - $ref: "#/components/schemas/fleet_submit_only"

    fleet_post:
      description: HTTP POST Fleet Entity Definition
      required:
        - name
      allOf:
        - $ref: "#/components/schemas/fleet_patch"

  responses:

    fleet:
      description: A fleet successfully retrieved.
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/fleet_get"
          examples:
            $ref: "fleets_examples.yaml#/unit/200"

    fleet_list:
      description: A list of fleets successfully retrieved.
      content:
        application/json:
          schema:
            type: array
            items:
              $ref: "#/components/schemas/fleet_get"
          examples:
            $ref: "fleets_examples.yaml#/list/200"


# ===================
# Fleets Paths (CRUD)
# ===================

paths:

  /fleets:
    summary: Manage Fleet Information.
    description: This endpoint allows clients to retrieve a list of fleets, add new fleets, and manage existing fleet data. It supports both retrieval and submission of fleet information, including details such as fleet name and associated vehicles.

    get:
      operationId: fleets-get
      tags: [ fleets ]
      summary: Retrieve a List of Fleets.
      description: Fetches a list of all fleets registered in the system. The response includes details such as fleet name and the vehicles associated with each fleet.
      responses:
        "200":
          $ref: "#/components/responses/fleet_list"
        "401":
          $ref: "components.yaml#/components/responses/unauthorized"

    post:
      operationId: fleets-post
      tags: [ fleets ]
      summary: Add a New Fleet.
      description: Submits a new fleet to the system. The request must include fleet details such as name and associated vehicles. A successful response returns the newly created fleet's information.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/fleet_post"
            examples:
              $ref: "fleets_examples.yaml#/request/create"
      responses:
        "201":
          description: Fleet successfully created.
          headers:
            Location:
              $ref: "components.yaml#/components/headers/created_url"
          $ref: "#/components/responses/fleet"
        "401":
          $ref: "components.yaml#/components/responses/unauthorized"

  /fleets/{id}:
    parameters:
      - $ref: "components.yaml#/components/parameters/path_id"

    get:
      operationId: fleets-id-get
      tags: [ fleets ]
      summary: Retrieve Fleet Information by ID.
      description: Fetches detailed information about a specific fleet identified by its unique ID. The response includes all relevant fleet details such as name and associated vehicles.
      responses:
        "200":
          description: Fleet successfully retrieved.
          $ref: "#/components/responses/fleet"
        "404":
          $ref: "components.yaml#/components/responses/notfound"
        "401":
          $ref: "components.yaml#/components/responses/unauthorized"

    patch:
      operationId: fleets-id-put
      tags: [ fleets ]
      summary: Update Fleet Information by ID.
      description: Updates the details of an existing fleet identified by its unique ID. The request must include the updated fleet information. A successful response returns the updated fleet's information.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/fleet_patch"
            examples:
              $ref: "fleets_examples.yaml#/request/update"
      responses:
        "200":
          description: Fleet successfully updated.
          $ref: "#/components/responses/fleet"
        "404":
          $ref: "components.yaml#/components/responses/notfound"
        "401":
          $ref: "components.yaml#/components/responses/unauthorized"

    delete:
      operationId: fleets-id-delete
      tags: [ fleets ]
      summary: Delete Fleet by ID.
      description: Deletes a specific fleet identified by its unique ID from the system. A successful response indicates that the fleet has been removed.
      responses:
        "200":
          description: Fleet successfully deleted.
          $ref: "components.yaml#/components/responses/ok"
        "404":
          $ref: "components.yaml#/components/responses/notfound"
        "401":
          $ref: "components.yaml#/components/responses/unauthorized"
