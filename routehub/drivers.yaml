# ==================
# Drivers Components
# ==================

components:

  schemas:

    driver_vehicle_base:
      description: Base Driver-Vehicle Entity Definition
      type: object
      required:
        - quantity
      properties:
        quantity:
          type: integer

    driver_vehicle_submit_only:
      description: Submit-Only Driver-Vehicle Entity Definition
      type: object
      required:
        - vehicle_id
      properties:
        vehicle_id:
          type: integer

    driver_base:
      description: Base Driver Entity Definition
      type: object
      properties:
        first_name:
          type: string
        last_name:
          type: string
        work_schedules:
          description: "List of work schedules"
          type: array
          items:
            description: "RFC 5545 (iCalendar: Internet Calendaring and Scheduling Core Object Specification)"
            type: string
        start_point:
          description: "ISO 6709:DD (Standard representation of geographic point location by coordinates)"
          type: string
        end_point:
          description: "ISO 6709:DD (Standard representation of geographic point location by coordinates)"
          type: string
        work_areas:
          description: "A collection of geographic working areas."
          type: array
          items:
            description: |
              A single working area expressed as an ordered list of ISO 6709:DD
              (latitude/longitude coordinates in decimal‑degrees format). The list
              must contain at least three points, forming a closed polygon.
            type: array
            minItems: 3
            items:
              description: "ISO 6709:DD (geographic point)"
              type: string

    driver_submit_only:
      description: Submit-Only Driver Entity Definition
      type: object
      properties:
        vehicles:
          type: array
          items:
            allOf:
              - $ref: "#/components/schemas/driver_vehicle_base"
              - $ref: "#/components/schemas/driver_vehicle_submit_only"

    driver_response_only:
      description: Response-Only Driver Entity Definition
      type: object
      properties:
        vehicles:
          type: array
          items:
            allOf:
              - $ref: "#/components/schemas/driver_vehicle_base"
              - $ref: "vehicles.yaml#/components/schemas/vehicle_get"

    driver_get:
      description: HTTP GET Driver Entity Definition
      required:
        - id
        - first_name
      allOf:
        - $ref: "components.yaml#/components/schemas/id_number"
        - $ref: "#/components/schemas/driver_base"
        - $ref: "#/components/schemas/driver_response_only"

    driver_patch:
      description: HTTP PATCH Driver Entity Definition
      allOf:
        - $ref: "#/components/schemas/driver_base"
        - $ref: "#/components/schemas/driver_submit_only"

    driver_post:
      description: HTTP POST Driver Entity Definition
      required:
        - first_name
      allOf:
        - $ref: "#/components/schemas/driver_patch"

  responses:

      driver:
        description: A driver successfully retrieved.
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/driver_get"
            examples:
              $ref: "drivers_examples.yaml#/unit/200"

      driver_list:
        description: A list of drivers successfully retrieved.
        content:
          application/json:
            schema:
              type: array
              items:
                $ref: "#/components/schemas/driver_get"
            examples:
              $ref: "drivers_examples.yaml#/list/200"


# ====================
# Drivers Paths (CRUD)
# ====================

paths:

  /drivers:
    summary: Driver collection endpoint.
    description: This endpoint allows retrieving, creating, and managing a collection of driver resources.

    get:
      operationId: drivers-get
      tags: [ drivers ]
      summary: Retrieve all drivers.
      description: Retrieves a list of all drivers.
      responses:
        "200":
          $ref: "#/components/responses/driver_list"
        "401":
          $ref: "components.yaml#/components/responses/unauthorized"

    post:
      operationId: drivers-post
      tags: [ drivers ]
      summary: Create a new driver.
      description: Creates a new driver resource.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/driver_post"
            examples:
              $ref: "drivers_examples.yaml#/request/create"
      responses:
        "201":
          description: Driver successfully created.
          headers:
            Location:
              $ref: "components.yaml#/components/headers/created_url"
          $ref: "#/components/responses/driver"
        "401":
          $ref: "components.yaml#/components/responses/unauthorized"

  /drivers/{id}:
    parameters:
      - $ref: "components.yaml#/components/parameters/path_id_number"

    get:
      operationId: drivers-id-get
      tags: [ drivers ]
      summary: Retrieve a driver by ID.
      description: Retrieves a specific driver by its ID.
      responses:
        "200":
          description: Driver successfully retrieved.
          $ref: "#/components/responses/driver"
        "404":
          $ref: "components.yaml#/components/responses/notfound"
        "401":
          $ref: "components.yaml#/components/responses/unauthorized"

    patch:
      operationId: drivers-id-put
      tags: [ drivers ]
      summary: Update a driver by ID.
      description: Updates an existing driver resource identified by its ID.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/driver_patch"
            examples:
              $ref: "drivers_examples.yaml#/request/update"
      responses:
        "200":
          description: Driver successfully updated.
          $ref: "#/components/responses/driver"
        "404":
          $ref: "components.yaml#/components/responses/notfound"
        "401":
          $ref: "components.yaml#/components/responses/unauthorized"

    delete:
      operationId: drivers-id-delete
      tags: [ drivers ]
      summary: Delete a driver by ID.
      description: Deletes a specific driver by its ID.
      responses:
        "200":
          description: Driver successfully deleted.
          $ref: "components.yaml#/components/responses/ok"
        "404":
          $ref: "components.yaml#/components/responses/notfound"
        "401":
          $ref: "components.yaml#/components/responses/unauthorized"
